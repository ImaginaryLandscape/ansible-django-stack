---

- name: Load a variable file based on the OS type, or a default if not found. Using free-form to specify the file.
  include_vars: "{{ item }}"
  with_first_found:
   - "vars/os-{{ ansible_distribution|lower }}-{{ ansible_distribution_release }}.yml"
   - "vars/os-{{ ansible_distribution|lower }}.yml"
   - "vars/os-{{ ansible_os_family|lower }}.yml"
   - "vars/os-default.yml"
  loop_control:
    loop_var: item

- include: install_facts.yml
  when: nginx__install_facts

- name: Load OS-Specific Tasks
  include: "{{ item }}"
  with_first_found:
   - "os-{{ ansible_distribution|lower }}-{{ ansible_distribution_release }}.yml"
   - "os-{{ ansible_distribution|lower }}.yml"
   - "os-{{ ansible_os_family|lower }}.yml"
   - "os-default.yml"
